(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2708],{35695:(e,r,a)=>{"use strict";var s=a(18999);a.o(s,"useParams")&&a.d(r,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(r,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(r,{useSearchParams:function(){return s.useSearchParams}})},62139:(e,r,a)=>{Promise.resolve().then(a.bind(a,94822))},94822:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>n});var s=a(95155),t=a(12115),d=a(12108),l=a(35695);function n(){let{data:e,status:r}=(0,d.useSession)(),a=(0,l.useRouter)(),[n,o]=(0,t.useState)(!1),[i,c]=(0,t.useState)(""),[m,u]=(0,t.useState)([]),[x,b]=(0,t.useState)({name:"",email:"",password:"",role:"USER",department:"",departmentId:"",isActive:!0});if("loading"===r)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-orange"})});if(!e||"ADMIN"!==e.user.role)return a.push("/dashboard"),null;(0,t.useEffect)(()=>{e&&"ADMIN"===e.user.role&&h()},[e]);let h=async()=>{try{let e=await fetch("/api/departments?active=true");if(e.ok){let r=await e.json();u(r.departments)}}catch(e){console.error("Failed to fetch departments:",e)}},p=async e=>{e.preventDefault(),o(!0),c("");try{let e=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}),r=await e.json();e.ok?a.push("/admin/users"):(c(r.error||"Failed to create user"),r.details&&c("".concat(r.error,": ").concat(r.details.join(", "))))}catch(e){console.error("Failed to create user:",e),c("Failed to create user. Please try again.")}finally{o(!1)}},g=e=>{let{name:r,value:a,type:s}=e.target;b(t=>({...t,[r]:"checkbox"===s?e.target.checked:a}))};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,s.jsx)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm shadow-sm border-b border-gray-700",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"flex justify-between items-center py-6",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>a.back(),className:"text-white/60 dark:text-white/60 hover:text-slate-500 dark:hover:text-slate-200",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-brand-primary-text",children:"Add New User"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-brand-secondary-text",children:"Create a new system user account"})]})]})})})}),(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-2xl border border-gray-300 dark:border-gray-600 shadow-xl shadow-gray-200/20 dark:shadow-gray-900/30 p-6",children:[i&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-red-400 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,s.jsx)("p",{className:"text-sm text-red-700 mt-1",children:i})]})]})}),(0,s.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name *"}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",value:x.name,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter full name"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address *"}),(0,s.jsx)("input",{type:"email",id:"email",name:"email",value:x.email,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter email address"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password *"}),(0,s.jsx)("input",{type:"password",id:"password",name:"password",value:x.password,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter secure password"}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-brand-secondary-text mt-1",children:"Password must be at least 8 characters with uppercase, lowercase, number, and special character."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-300 mb-2",children:"Role *"}),(0,s.jsxs)("select",{id:"role",name:"role",value:x.role,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"VIEWER",children:"Viewer - Read-only access"}),(0,s.jsx)("option",{value:"USER",children:"User - Basic operations"}),(0,s.jsx)("option",{value:"MANAGER",children:"Manager - Advanced operations"}),(0,s.jsx)("option",{value:"ADMIN",children:"Admin - Full system access"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"departmentId",className:"block text-sm font-medium text-gray-300 mb-2",children:"Department"}),(0,s.jsxs)("select",{id:"departmentId",name:"departmentId",value:x.departmentId,onChange:g,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"No Department"}),m.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name,e.description&&" - ".concat(e.description)]},e.id))]})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isActive",name:"isActive",checked:x.isActive,onChange:g,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-600 rounded"}),(0,s.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-300",children:"Account is active (user can sign in)"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-700",children:[(0,s.jsx)("button",{type:"button",onClick:()=>a.back(),className:"px-4 py-2 text-gray-300 hover border border-gray-600 rounded-lg hover transition-colors",children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",disabled:n,className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 disabled:from-blue-400 disabled:to-blue-400 text-white rounded-xl font-semibold transition-all duration-200 shadow-lg shadow-blue-500/25 hover:shadow-blue-500/40 transform hover:scale-[1.02] disabled:transform-none disabled:shadow-none",children:[n&&(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("span",{children:n?"Creating...":"Create User"})]})]})]})]})})]})}}},e=>{e.O(0,[2108,8441,5964,7358],()=>e(e.s=62139)),_N_E=e.O()}]);