(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{9246:(e,t,r)=>{Promise.resolve().then(r.bind(r,21648))},21648:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(95155),a=r(12115),n=r(12108),l=r(35695),i=r(98273);function d(e){let{isOpen:t,onClose:r,user:n,onSuccess:l}=e;(0,i.K)(t);let[d,o]=(0,a.useState)(!1),[c,m]=(0,a.useState)(""),[x,u]=(0,a.useState)(""),[h,p]=(0,a.useState)(!1),b=async()=>{if(n){o(!0),m("");try{let e=await fetch("/api/users/".concat(n.id,"/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"}}),t=await e.json();e.ok?(u(t.temporaryPassword),p(!0),l()):m(t.error||"Failed to reset password")}catch(e){console.error("Password reset error:",e),m("Network error occurred")}finally{o(!1)}}},g=()=>{m(""),u(""),p(!1),o(!1),r()},y=async()=>{try{await navigator.clipboard.writeText(x)}catch(e){console.error("Failed to copy to clipboard:",e)}};return t&&n?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsx)("div",{className:"bg-gray-900 rounded-lg max-w-md w-full border border-gray-700",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-brand-primary-text",children:h?"Password Reset Complete":"Reset Password"}),(0,s.jsx)("button",{onClick:g,className:"text-white/50 hover:text-white/80 transition-colors hover transition-colors",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-green-500/20 rounded-full flex items-center justify-center mr-3",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsxs)("p",{className:"text-sm text-brand-primary-text",children:["Password reset successfully for ",(0,s.jsx)("strong",{children:n.name||n.email})]})]}),(0,s.jsxs)("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-yellow-300 mb-2",children:"Temporary Password:"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("code",{className:"flex-1 bg-gray-800 border border-gray-600 rounded px-3 py-2 text-sm font-mono text-brand-primary-text",children:x}),(0,s.jsx)("button",{onClick:y,className:"px-3 py-2 text-sm text-blue-400 hover:text-blue-300 border border-blue-500/30 rounded hover:border-blue-500/50 transition-colors",children:"Copy"})]}),(0,s.jsx)("p",{className:"text-xs text-yellow-200 mt-2",children:"⚠️ Please share this password securely with the user and ask them to change it immediately after login."})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{onClick:g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover rounded-md transition-colors",children:"Done"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("p",{className:"text-sm text-brand-primary-text mb-4",children:"Are you sure you want to reset the password for:"}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"font-medium text-brand-primary-text",children:n.name||"Unnamed User"}),(0,s.jsx)("p",{className:"text-sm text-brand-primary-text",children:n.email})]}),(0,s.jsx)("p",{className:"text-sm text-brand-primary-text mt-4",children:"This will generate a new temporary password that you'll need to share with the user."})]}),c&&(0,s.jsx)("div",{className:"mb-4 bg-red-500/20 border border-red-500/30 rounded-lg p-3",children:(0,s.jsx)("p",{className:"text-red-300 text-sm",children:c})}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:g,disabled:d,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-900 border border-gray-600 rounded-md hover transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:b,disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-orange-600 hover disabled:opacity-50 rounded-md transition-colors",children:d?"Resetting...":"Reset Password"})]})]})]})})}):null}function o(e){let{isOpen:t,onClose:r,onSuccess:n}=e;(0,i.K)(t);let[l,d]=(0,a.useState)(!1),[o,c]=(0,a.useState)(""),[m,x]=(0,a.useState)([]),[u,h]=(0,a.useState)({name:"",email:"",password:"",role:"USER",department:"",departmentId:"",isActive:!0});(0,a.useEffect)(()=>{t&&p()},[t]);let p=async()=>{try{let e=await fetch("/api/departments?active=true");if(e.ok){let t=await e.json();x(t.departments)}}catch(e){console.error("Failed to fetch departments:",e)}},b=async e=>{e.preventDefault(),d(!0),c("");try{let e=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),t=await e.json();e.ok?(h({name:"",email:"",password:"",role:"USER",department:"",departmentId:"",isActive:!0}),n(),r()):(c(t.error||"Failed to create user"),t.details&&c("".concat(t.error,": ").concat(t.details.join(", "))))}catch(e){console.error("Failed to create user:",e),c("Failed to create user. Please try again.")}finally{d(!1)}},g=e=>{let{name:t,value:r,type:s}=e.target;h(a=>({...a,[t]:"checkbox"===s?e.target.checked:r}))},y=()=>{c(""),h({name:"",email:"",password:"",role:"USER",department:"",departmentId:"",isActive:!0}),r()};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsx)("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-gray-700",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-brand-primary-text",children:"Add New User"}),(0,s.jsx)("button",{onClick:y,className:"text-white/50 hover:text-white/80 transition-colors hover transition-colors",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/30 rounded-lg",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-red-400 mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-300",children:"Error"}),(0,s.jsx)("p",{className:"text-sm text-red-200 mt-1",children:o})]})]})}),(0,s.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name *"}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",value:u.name,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter full name"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address *"}),(0,s.jsx)("input",{type:"email",id:"email",name:"email",value:u.email,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter email address"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password *"}),(0,s.jsx)("input",{type:"password",id:"password",name:"password",value:u.password,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter secure password"}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-brand-secondary-text mt-1",children:"Password must be at least 8 characters with uppercase, lowercase, number, and special character."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-300 mb-2",children:"Role *"}),(0,s.jsxs)("select",{id:"role",name:"role",value:u.role,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"VIEWER",children:"Viewer - Read-only access"}),(0,s.jsx)("option",{value:"USER",children:"User - Basic operations"}),(0,s.jsx)("option",{value:"MANAGER",children:"Manager - Advanced operations"}),(0,s.jsx)("option",{value:"ADMIN",children:"Admin - Full system access"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"departmentId",className:"block text-sm font-medium text-gray-300 mb-2",children:"Department"}),(0,s.jsxs)("select",{id:"departmentId",name:"departmentId",value:u.departmentId,onChange:g,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"No Department"}),m.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name,e.description&&" - ".concat(e.description)]},e.id))]})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isActive",name:"isActive",checked:u.isActive,onChange:g,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-600 rounded"}),(0,s.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-300",children:"Account is active (user can sign in)"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-700",children:[(0,s.jsx)("button",{type:"button",onClick:y,disabled:l,className:"px-4 py-2 text-gray-300 hover border border-gray-600 rounded-lg hover transition-colors",children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-600 hover disabled:opacity-50 text-white rounded-lg transition-colors flex items-center space-x-2",children:[l&&(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("span",{children:l?"Creating...":"Create User"})]})]})]})]})})}):null}var c=r(80280);function m(e){let{isOpen:t,onClose:r,userToDelete:n,onTransferComplete:l}=e;(0,i.K)(t);let[d,o]=(0,a.useState)([]),[m,x]=(0,a.useState)(""),[u,h]=(0,a.useState)([]),[p,b]=(0,a.useState)(!1),[g,y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t&&n&&(f(),v())},[t,n]);let f=async()=>{try{let e=await fetch("/api/users?active=true");if(e.ok){let t=(await e.json()).users.filter(e=>e.id!==(null==n?void 0:n.id)&&e.isActive);o(t)}}catch(e){console.error("Failed to fetch users:",e)}},v=async()=>{if(n)try{b(!0);let e=await fetch("/api/users/".concat(n.id,"/transfer"));if(e.ok){let t=await e.json();h(t.activeTransactions||[])}}catch(e){console.error("Failed to fetch active transactions:",e)}finally{b(!1)}},j=async()=>{if(m&&n)try{y(!0);let e=await fetch("/api/users/".concat(n.id,"/transfer"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({toUserId:m})});if(e.ok){let t=await e.json();alert("Successfully transferred ".concat(t.transferredCount," checked-out items to ").concat(t.toUser.name||t.toUser.email)),l(),r()}else{let t=await e.json();alert("Transfer failed: ".concat(t.error))}}catch(e){console.error("Transfer failed:",e),alert("Transfer failed. Please try again.")}finally{y(!1)}};if(!n)return null;let k=d.find(e=>e.id===m);return(0,s.jsxs)(c.lG,{open:t,onClose:r,className:"relative z-50",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/25"}),(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,s.jsxs)(c.Lj,{className:"mx-auto max-w-2xl rounded-lg bg-gray-900 p-6 shadow-xl",children:[(0,s.jsx)(c.L3,{className:"text-lg font-medium text-brand-primary-text mb-4",children:"Transfer Checked-Out Items"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"bg-amber-500/20 border border-amber-500/30 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-amber-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-amber-300",children:"Cannot delete user with checked-out items"}),(0,s.jsx)("div",{className:"mt-2 text-sm text-amber-200",children:(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:n.name||n.email})," has ",u.length," checked-out item",1!==u.length?"s":""," that must be transferred to another user before deletion."]})})]})]})}),p?(0,s.jsx)("div",{className:"text-center py-4",children:(0,s.jsx)("div",{className:"text-white/50 hover:text-white/80 transition-colors",children:"Loading transactions..."})}):(0,s.jsxs)(s.Fragment,{children:[u.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-sm font-medium text-brand-primary-text mb-2",children:["Checked-out items (",u.length,"):"]}),(0,s.jsx)("div",{className:"bg-gray-800/50 rounded-lg p-3 max-h-32 overflow-y-auto",children:(0,s.jsx)("div",{className:"space-y-1",children:u.map(e=>(0,s.jsxs)("div",{className:"text-sm text-gray-300",children:["• ",e.asset.name," ",e.asset.serialNumber&&"(".concat(e.asset.serialNumber,")")]},e.id))})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"transferUser",className:"block text-sm font-medium text-gray-300 mb-2",children:"Transfer to user:"}),(0,s.jsxs)("select",{id:"transferUser",value:m,onChange:e=>x(e.target.value),className:"w-full border border-gray-600 rounded-md px-3 py-2 bg-gray-900 text-brand-primary-text focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select a user..."}),d.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name||e.email," (",e.role,")"]},e.id))]})]}),k&&(0,s.jsx)("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"text-sm text-blue-300",children:[(0,s.jsx)("strong",{children:"Selected:"})," ",k.name||k.email," (",k.role,")"]})})]})]}),(0,s.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:r,className:"px-4 py-2 border border-gray-600 rounded-md text-sm font-medium text-gray-300 hover bg-gray-900 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{confirm("Are you sure you want to skip the transfer? This will result in the user being deactivated instead of deleted.")&&(l(),r())},className:"px-4 py-2 border border-gray-600 rounded-md text-sm font-medium text-gray-300 hover bg-gray-900 transition-colors",children:"Skip Transfer (Deactivate User)"}),(0,s.jsx)("button",{onClick:j,disabled:!m||g||0===u.length,className:"bg-blue-600 hover disabled:opacity-50 disabled:cursor-not-allowed text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:g?"Transferring...":"Transfer & Delete User"})]})]})})]})}function x(e){let{isOpen:t,onClose:r,user:n,onSuccess:l}=e,[i,d]=(0,a.useState)(!1),[o,m]=(0,a.useState)(""),[x,u]=(0,a.useState)({name:"",email:"",role:"",department:"",isActive:!0,password:""});(0,a.useEffect)(()=>{n&&t&&u({name:n.name||"",email:n.email||"",role:n.role||"",department:n.department||"",isActive:n.isActive,password:""}),m("")},[n,t]);let h=e=>{let{name:t,value:r,type:s}=e.target;if("checkbox"===s){let r=e.target.checked;u(e=>({...e,[t]:r}))}else u(e=>({...e,[t]:r}))},p=async e=>{if(e.preventDefault(),n){d(!0),m("");try{let e={name:x.name.trim(),email:x.email.trim(),role:x.role,department:x.department.trim()||null,isActive:x.isActive};x.password.trim()&&(e.password=x.password.trim());let t=await fetch("/api/users/".concat(n.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)l(),r();else{let e=await t.json();m(e.error||"Failed to update user")}}catch(e){console.error("Edit user error:",e),m("Network error occurred")}finally{d(!1)}}},b=()=>{m(""),u({name:"",email:"",role:"",department:"",isActive:!0,password:""}),r()};return t&&n?(0,s.jsxs)(c.lG,{open:t,onClose:b,className:"relative z-50",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/25 backdrop-blur-sm","aria-hidden":"true"}),(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,s.jsx)(c.lG.Panel,{className:"mx-auto max-w-2xl w-full bg-gray-900 rounded-2xl shadow-2xl border border-gray-700 max-h-[90vh] overflow-hidden",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"p-2 bg-white/5 dark:bg-white/5 hover:bg-white/10 dark:hover:bg-white/10 rounded-lg transition-colors",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,s.jsx)(c.lG.Title,{className:"text-xl font-semibold text-brand-primary-text",children:"Edit User"})]}),(0,s.jsx)("button",{onClick:b,className:"text-white/50 hover:text-white/80 transition-colors hover transition-colors",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm text-red-300",children:o})}),(0,s.jsx)("div",{className:"max-h-[calc(90vh-200px)] overflow-y-auto",children:(0,s.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-1",children:"Full Name *"}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",required:!0,value:x.name,onChange:h,className:"w-full px-3 py-2 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-900 text-brand-primary-text",placeholder:"Enter full name"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-1",children:"Email Address *"}),(0,s.jsx)("input",{type:"email",id:"email",name:"email",required:!0,value:x.email,onChange:h,className:"w-full px-3 py-2 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-900 text-brand-primary-text",placeholder:"Enter email address"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-300 mb-1",children:"Role *"}),(0,s.jsxs)("select",{id:"role",name:"role",required:!0,value:x.role,onChange:h,className:"w-full px-3 py-2 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-900 text-brand-primary-text",children:[(0,s.jsx)("option",{value:"",children:"Select Role"}),(0,s.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,s.jsx)("option",{value:"MANAGER",children:"Manager"}),(0,s.jsx)("option",{value:"USER",children:"User"}),(0,s.jsx)("option",{value:"VIEWER",children:"Viewer"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-300 mb-1",children:"Department"}),(0,s.jsx)("input",{type:"text",id:"department",name:"department",value:x.department,onChange:h,className:"w-full px-3 py-2 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-900 text-brand-primary-text",placeholder:"Enter department (optional)"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"New Password"}),(0,s.jsx)("input",{type:"password",id:"password",name:"password",value:x.password,onChange:h,className:"w-full px-3 py-2 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-900 text-brand-primary-text",placeholder:"Leave blank to keep current password"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-white/50 hover:text-white/80 transition-colors",children:"Leave blank to keep the current password unchanged"})]}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isActive",name:"isActive",checked:x.isActive,onChange:h,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-600 rounded"}),(0,s.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-300",children:"Active user (can log in and access the system)"})]})})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-700",children:[(0,s.jsx)("button",{type:"button",onClick:b,disabled:i,className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-800 hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:i||!x.name.trim()||!x.email.trim()||!x.role,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors",children:i?"Updating...":"Update User"})]})]})})]})})})]}):null}function u(e){var t;let{user:r,onToggleStatus:a,onEdit:n,onPasswordReset:l,onDelete:i}=e;return(0,s.jsxs)("div",{className:"bg-white dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white font-medium text-sm",children:r.name?r.name.charAt(0).toUpperCase():null==(t=r.email)?void 0:t.charAt(0).toUpperCase()})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-brand-primary-text truncate",children:r.name||"No name"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:r.email}),r.department&&(0,s.jsx)("div",{className:"text-xs text-gray-600 dark:text-brand-secondary-text mt-0.5",children:r.department})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end space-y-1",children:[(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat((e=>{switch(e){case"ADMIN":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";case"MANAGER":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"USER":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300"}})(r.role)),children:r.role}),(0,s.jsx)("button",{onClick:()=>a(r.id,r.isActive),className:"px-2 py-1 text-xs font-medium rounded-full transition-colors ".concat(r.isActive?"bg-green-100 text-green-800 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-300"),children:r.isActive?"Active":"Inactive"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-brand-primary-text font-semibold",children:r._count.createdAssets}),(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Assets"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-brand-primary-text font-semibold",children:r._count.transactions}),(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Transactions"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-brand-primary-text font-semibold",children:r._count.maintenanceRecords}),(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Maintenance"})]})]}),(0,s.jsxs)("div",{className:"text-xs text-center",children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Last login: "}),(0,s.jsx)("span",{className:"text-brand-primary-text",children:r.lastLoginAt?new Date(r.lastLoginAt).toLocaleDateString():"Never"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("button",{onClick:()=>n(r),className:"flex items-center justify-center px-2 py-2 bg-blue-100 hover:bg-blue-200 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-md transition-colors text-xs font-medium active:scale-95 touch-manipulation",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),(0,s.jsxs)("button",{onClick:()=>l(r),className:"flex items-center justify-center px-2 py-2 bg-orange-100 hover:bg-orange-200 dark:bg-orange-900/30 dark:hover:bg-orange-900/50 text-orange-700 dark:text-orange-300 rounded-md transition-colors text-xs font-medium active:scale-95 touch-manipulation",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m0 0a2 2 0 01-2 2m2-2h6m-6 0H9m12 0v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2h4m6 0V7a2 2 0 112 2v0z"})}),"Reset"]}),(0,s.jsxs)("button",{onClick:()=>i(r),className:"flex items-center justify-center px-2 py-2 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-900/50 text-red-700 dark:text-red-300 rounded-md transition-colors text-xs font-medium active:scale-95 touch-manipulation",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]})}function h(){let{data:e,status:t}=(0,n.useSession)(),r=(0,l.useRouter)(),[i,c]=(0,a.useState)([]),[h,p]=(0,a.useState)(!0),[b,g]=(0,a.useState)(""),[y,f]=(0,a.useState)(""),[v,j]=(0,a.useState)(""),[k,N]=(0,a.useState)(!1),[w,C]=(0,a.useState)(!1),[A,S]=(0,a.useState)(!1),[L,E]=(0,a.useState)(!1),[M,R]=(0,a.useState)(null),[U,F]=(0,a.useState)(null);(0,a.useEffect)(()=>{if("loading"!==t){if(!e)return void r.push("/auth/signin");if("ADMIN"!==e.user.role)return void r.push("/dashboard");T()}},[e,t,r]);let T=async()=>{try{let e=new URLSearchParams;b&&e.append("search",b),y&&e.append("role",y),v&&e.append("active",v);let t=await fetch("/api/users?".concat(e));if(t.ok){let e=await t.json();c(e.users)}p(!1)}catch(e){console.error("Failed to fetch users:",e),p(!1)}};(0,a.useEffect)(()=>{e&&T()},[b,y,v]);let P=async(e,t)=>{try{(await fetch("/api/users/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!t})})).ok&&T()}catch(e){console.error("Failed to update user status:",e)}},D=async e=>{if(confirm("Are you sure you want to delete ".concat(e.name||e.email,"?")))try{let t=await fetch("/api/users/".concat(e.id),{method:"DELETE"});if(t.ok)T();else{let r=await t.json();if(r.details&&r.details.activeCheckouts>0)F(e),S(!0);else if(r.details){let e=r.details,t=[];e.assets>0&&t.push("".concat(e.assets," assets")),e.transactions>0&&t.push("".concat(e.transactions," transactions")),e.maintenanceRecords>0&&t.push("".concat(e.maintenanceRecords," maintenance records")),alert("Cannot delete user: They have ".concat(t.join(", "),".\n\nTip: Deactivate the user instead by clicking their Active/Inactive status."))}else alert("Error: ".concat(r.error))}}catch(e){console.error("Failed to delete user:",e),alert("Failed to delete user")}},W=async()=>{if(U){try{(await fetch("/api/users/".concat(U.id),{method:"DELETE"})).ok?(alert("User ".concat(U.name||U.email," has been deleted successfully.")),T()):(await fetch("/api/users/".concat(U.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!1})})).ok?(alert("User ".concat(U.name||U.email," has been deactivated instead of deleted due to remaining dependencies.")),T()):alert("Failed to delete or deactivate user after transfer.")}catch(e){console.error("Failed to complete user deletion:",e),alert("Failed to complete user deletion after transfer.")}F(null)}};return"loading"===t||h?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-orange"})}):e&&"ADMIN"===e.user.role?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,s.jsx)("div",{className:"max-w-7xl mx-auto py-3 sm:py-4 md:py-6 px-3 sm:px-4 md:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"space-y-4 sm:space-y-6 md:space-y-8",children:[(0,s.jsx)("div",{className:"text-center sm:text-left",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-3 sm:space-y-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("button",{onClick:()=>r.back(),className:"text-gray-600 dark:text-gray-400 hover:text-brand-primary-text transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-brand-primary-text",children:"User Management"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm md:text-base text-gray-600 dark:text-brand-secondary-text mt-1",children:"Manage system users and permissions"})]})]}),(0,s.jsxs)("button",{onClick:()=>C(!0),className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 sm:px-6 sm:py-3 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg sm:rounded-xl font-semibold text-sm transition-all duration-200 shadow-lg shadow-blue-500/25 hover:shadow-blue-500/40 transform hover:scale-[1.02] active:scale-95 touch-manipulation",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add User"]})]})}),(0,s.jsx)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg border border-gray-200 dark:border-gray-700 p-3 sm:p-4 md:p-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[(0,s.jsxs)("div",{className:"sm:col-span-2 lg:col-span-1",children:[(0,s.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-gray-600 dark:text-brand-secondary-text mb-1",children:"Search Users"}),(0,s.jsx)("input",{type:"text",placeholder:"Search by name, email...",value:b,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white/80 dark:bg-white/5 text-gray-900 dark:text-brand-primary-text placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-gray-600 dark:text-brand-secondary-text mb-1",children:"Role"}),(0,s.jsxs)("select",{value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white/80 dark:bg-white/5 text-gray-900 dark:text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[(0,s.jsx)("option",{value:"",children:"All Roles"}),(0,s.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,s.jsx)("option",{value:"MANAGER",children:"Manager"}),(0,s.jsx)("option",{value:"USER",children:"User"}),(0,s.jsx)("option",{value:"VIEWER",children:"Viewer"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-gray-600 dark:text-brand-secondary-text mb-1",children:"Status"}),(0,s.jsxs)("select",{value:v,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white/80 dark:bg-white/5 text-gray-900 dark:text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[(0,s.jsx)("option",{value:"",children:"All Status"}),(0,s.jsx)("option",{value:"true",children:"Active"}),(0,s.jsx)("option",{value:"false",children:"Inactive"})]})]}),(0,s.jsx)("div",{className:"flex items-end sm:col-span-2 lg:col-span-1",children:(0,s.jsx)("button",{onClick:()=>{g(""),f(""),j("")},className:"w-full px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg transition-colors text-sm font-medium active:scale-95 touch-manipulation",children:"Clear Filters"})})]})}),(0,s.jsxs)("div",{className:"md:hidden space-y-3",children:[i.map(e=>(0,s.jsx)(u,{user:e,onToggleStatus:P,onEdit:e=>{R(e),E(!0)},onPasswordReset:e=>{R(e),N(!0)},onDelete:D},e.id)),0===i.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-medium text-brand-primary-text",children:"No users found"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-brand-secondary-text",children:"Get started by creating a new user."}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsxs)("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md transition-colors active:scale-95 touch-manipulation",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add User"]})})]})]}),(0,s.jsxs)("div",{className:"hidden md:block bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,s.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"User"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Role"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Department"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Activity"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Last Login"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white dark:bg-brand-dark-blue/90 divide-y divide-gray-200 dark:divide-gray-700",children:i.map(e=>{var t;return(0,s.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white font-medium text-sm",children:e.name?e.name.charAt(0).toUpperCase():null==(t=e.email)?void 0:t.charAt(0).toUpperCase()})})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-brand-primary-text",children:e.name||"No name"}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-brand-secondary-text",children:e.email})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"ADMIN":return"bg-red-100 text-red-800";case"MANAGER":return"bg-blue-100 text-blue-800";case"USER":return"bg-green-100 text-green-800";default:return"bg-gray-100 dark:bg-gray-800 text-brand-primary-text"}})(e.role)),children:e.role})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-brand-secondary-text",children:e.department||"-"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-brand-secondary-text",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{children:[e._count.createdAssets," assets"]}),(0,s.jsxs)("div",{children:[e._count.transactions," transactions"]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("button",{onClick:()=>P(e.id,e.isActive),className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors ".concat(e.isActive?"bg-green-100 text-green-800 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-300"),children:e.isActive?"Active":"Inactive"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-brand-secondary-text",children:e.lastLoginAt?new Date(e.lastLoginAt).toLocaleDateString():"Never"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsxs)("button",{onClick:()=>{R(e),E(!0)},className:"inline-flex items-center px-3 py-1.5 bg-blue-100 hover:bg-blue-200 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-md transition-colors text-xs font-medium",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),(0,s.jsxs)("button",{onClick:()=>{R(e),N(!0)},className:"inline-flex items-center px-3 py-1.5 bg-orange-100 hover:bg-orange-200 dark:bg-orange-900/30 dark:hover:bg-orange-900/50 text-orange-700 dark:text-orange-300 rounded-md transition-colors text-xs font-medium",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m0 0a2 2 0 01-2 2m2-2h6m-6 0H9m12 0v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2h4m6 0V7a2 2 0 112 2v0z"})}),"Reset"]}),(0,s.jsxs)("button",{onClick:()=>D(e),className:"inline-flex items-center px-3 py-1.5 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-900/50 text-red-700 dark:text-red-300 rounded-md transition-colors text-xs font-medium",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})})]},e.id)})})]})}),0===i.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-medium text-brand-primary-text",children:"No users found"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-brand-secondary-text",children:"Get started by creating a new user."}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsxs)("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md transition-colors",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add User"]})})]})]})]})}),(0,s.jsx)(o,{isOpen:w,onClose:()=>C(!1),onSuccess:()=>{T()}}),(0,s.jsx)(d,{isOpen:k,onClose:()=>{N(!1),R(null)},user:M,onSuccess:()=>{console.log("Password reset successful")}}),(0,s.jsx)(x,{isOpen:L,onClose:()=>{E(!1),R(null)},user:M,onSuccess:()=>{T(),E(!1),R(null)}}),(0,s.jsx)(m,{isOpen:A,onClose:()=>{S(!1),F(null)},userToDelete:U,onTransferComplete:W})]}):null}},35695:(e,t,r)=>{"use strict";var s=r(18999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},98273:(e,t,r)=>{"use strict";r.d(t,{K:()=>a});var s=r(12115);function a(e){(0,s.useEffect)(()=>{if(!e)return;let t=document.body.style.overflow,r=document.body.style.paddingRight,s=window.innerWidth-document.documentElement.clientWidth;return document.body.style.overflow="hidden",s>0&&(document.body.style.paddingRight="".concat(s,"px")),()=>{document.body.style.overflow=t,document.body.style.paddingRight=r}},[e])}}},e=>{e.O(0,[2108,280,8441,5964,7358],()=>e(e.s=9246)),_N_E=e.O()}]);