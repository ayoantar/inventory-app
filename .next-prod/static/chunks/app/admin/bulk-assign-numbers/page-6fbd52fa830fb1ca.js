(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3860],{3734:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=t(95155),a=t(12108),l=t(35695),n=t(12115),i=t(48947);function d(){let{data:e,status:s}=(0,a.useSession)(),t=(0,l.useRouter)(),[d,o]=(0,n.useState)(null),[c,m]=(0,n.useState)(!0),[u,b]=(0,n.useState)(!1),[h,x]=(0,n.useState)(null);(0,n.useEffect)(()=>{var r;return"loading"===s?void 0:"unauthenticated"===s?void t.push("/auth/signin"):"ADMIN"!==(null==e||null==(r=e.user)?void 0:r.role)?void t.push("/dashboard"):void g()},[s,t,e]);let g=async()=>{try{let e=await fetch("/api/admin/bulk-assign-asset-numbers");if(e.ok){let s=await e.json();o(s)}}catch(e){console.error("Failed to fetch count:",e)}finally{m(!1)}},k=async()=>{if(confirm("This will assign asset numbers to ".concat(null==d?void 0:d.totalWithoutNumbers," assets. Continue?"))){b(!0),x(null);try{let e=await fetch("/api/admin/bulk-assign-asset-numbers",{method:"POST"}),s=await e.json();e.ok?(x("Success: ".concat(s.message)),g()):x("Error: ".concat(s.error))}catch(e){console.error("Failed to bulk assign:",e),x("Error: Failed to bulk assign asset numbers")}finally{b(!1)}}};return"loading"===s||c?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,r.jsx)(i.A,{}),(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-orange"})})]}):e&&"ADMIN"===e.user.role?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,r.jsx)(i.A,{}),(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-brand-primary-text",children:"Bulk Assign Asset Numbers"}),(0,r.jsx)("p",{className:"text-brand-primary-text mt-2",children:"Assign asset numbers to all assets that don't have them"})]}),(0,r.jsx)("button",{onClick:()=>t.back(),className:"text-white/60 dark:text-white/60 hover:text-slate-500 dark:hover:text-slate-200",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})]})}),(0,r.jsxs)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg border border-gray-700 p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-brand-primary-text mb-4",children:"Assets Without Asset Numbers"}),d&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-indigo-600 mb-4",children:d.totalWithoutNumbers}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-300",children:"Breakdown by Category:"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:d.breakdown.map(e=>(0,r.jsxs)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded p-2",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-brand-primary-text",children:e.category}),(0,r.jsxs)("div",{className:"text-xs text-gray-600 dark:text-brand-secondary-text",children:[e.count," assets"]})]},e.category))})]})]})]}),(0,r.jsxs)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg border border-gray-700 p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-brand-primary-text mb-4",children:"Bulk Assignment"}),(0,r.jsxs)("p",{className:"text-sm text-brand-primary-text mb-6",children:["This will automatically generate and assign unique asset numbers to all assets that currently don't have them. Asset numbers will follow the format: ",(0,r.jsxs)("code",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm px-2 py-1 rounded",children:["LSVR-","{CATEGORY}","-","{NUMBER}"]})]}),(0,r.jsxs)("button",{onClick:k,disabled:u||!d||0===d.totalWithoutNumbers,className:"bg-indigo-600 hover disabled:opacity-50 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center",children:[u&&(0,r.jsxs)("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l-3-2.647z"})]}),u?"Assigning...":"Assign Asset Numbers (".concat((null==d?void 0:d.totalWithoutNumbers)||0,")")]})]}),h&&(0,r.jsx)("div",{className:"rounded-lg border p-4 ".concat(h.startsWith("Success")?"bg-green-50 border-green-200 text-green-700":"bg-red-50 border-red-200 text-red-700"),children:(0,r.jsx)("p",{className:"font-medium",children:h})}),(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-yellow-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L4.316 15.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,r.jsxs)("div",{className:"text-sm text-yellow-700",children:[(0,r.jsx)("p",{className:"font-medium",children:"Warning"}),(0,r.jsx)("p",{children:"This operation cannot be undone. Asset numbers will be permanently assigned to assets. Make sure you want to proceed."})]})]})})]})]}):null}},55369:(e,s,t)=>{Promise.resolve().then(t.bind(t,3734))}},e=>{e.O(0,[2108,7244,8947,8441,5964,7358],()=>e(e.s=55369)),_N_E=e.O()}]);