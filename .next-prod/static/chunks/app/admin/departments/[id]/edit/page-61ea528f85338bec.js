(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3877],{56011:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(95155),s=a(12115),n=a(12108),d=a(35695),i=a(6874),l=a.n(i);function o(){let{data:e,status:t}=(0,n.useSession)(),a=(0,d.useRouter)(),i=(0,d.useParams)().id,[o,c]=(0,s.useState)(null),[m,u]=(0,s.useState)(!0),[b,x]=(0,s.useState)(!1),[p,h]=(0,s.useState)(""),[g,f]=(0,s.useState)({name:"",description:"",manager:"",isActive:!0});(0,s.useEffect)(()=>{var r;if("loading"===t)return;if(!e)return void a.push("/auth/signin");let s=null==(r=e.user)?void 0:r.role;if("ADMIN"!==s&&"MANAGER"!==s)return void a.push("/dashboard");y()},[t,e,a,i]);let y=async()=>{try{let e=await fetch("/api/departments/".concat(i));if(e.ok){let t=await e.json();c(t),f({name:t.name||"",description:t.description||"",manager:t.manager||"",isActive:t.isActive})}else h("Department not found")}catch(e){console.error("Failed to fetch department:",e),h("Failed to load department")}finally{u(!1)}},v=async e=>{e.preventDefault(),x(!0),h("");try{let e=await fetch("/api/departments/".concat(i),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(e.ok)a.push("/admin/departments");else{let t=await e.json();h(t.error||"Failed to update department")}}catch(e){console.error("Failed to update department:",e),h("Failed to update department")}finally{x(!1)}},j=async()=>{if(confirm("Are you sure you want to delete this department? This action cannot be undone.")){x(!0);try{let e=await fetch("/api/departments/".concat(i),{method:"DELETE"});if(e.ok)a.push("/admin/departments");else{let t=await e.json();h(t.error||"Failed to delete department")}}catch(e){console.error("Failed to delete department:",e),h("Failed to delete department")}finally{x(!1)}}};return"loading"===t||m?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-orange"})}):e?p&&!o?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-brand-primary-text mb-4",children:"Department Not Found"}),(0,r.jsx)(l(),{href:"/admin/departments",className:"text-blue-600 hover",children:"← Back to Departments"})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,r.jsx)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm shadow-sm border-b border-gray-700",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("button",{onClick:()=>a.back(),className:"text-blue-600 hover text-sm font-medium mb-2 inline-flex items-center",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-brand-primary-text",children:"Edit Department"}),o&&(0,r.jsxs)("p",{className:"text-brand-primary-text mt-1",children:[o.name," • ",o._count.users," user",1!==o._count.users?"s":""]})]})})})}),(0,r.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsx)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg border border-gray-700",children:(0,r.jsxs)("form",{onSubmit:v,className:"p-6 space-y-6",children:[p&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-red-800 text-sm",children:p})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Department Name *"}),(0,r.jsx)("input",{type:"text",required:!0,value:g.name,onChange:e=>f({...g,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter department name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),(0,r.jsx)("textarea",{value:g.description,onChange:e=>f({...g,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter department description"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Manager"}),(0,r.jsx)("input",{type:"text",value:g.manager,onChange:e=>f({...g,manager:e.target.value}),className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter manager name"})]}),(0,r.jsx)("div",{children:(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:g.isActive,onChange:e=>f({...g,isActive:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-600 rounded"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-300",children:"Department is active"})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-gray-700",children:[(0,r.jsx)("button",{type:"button",onClick:j,disabled:b,className:"bg-red-600 hover disabled:opacity-50 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Delete Department"}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>a.back(),className:"bg-gray-300 hover text-gray-300 px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:b,className:"bg-blue-600 hover disabled:opacity-50 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:b?"Saving...":"Save Changes"})]})]})]})})})]}):null}},84152:(e,t,a)=>{Promise.resolve().then(a.bind(a,56011))}},e=>{e.O(0,[2108,7244,8441,5964,7358],()=>e(e.s=84152)),_N_E=e.O()}]);