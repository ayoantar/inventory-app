(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5494],{15155:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var r=a(95155),s=a(12108),n=a(35695),d=a(12115),i=a(6874),o=a.n(i),l=a(48947),c=a(61287);let m={SCHEDULED:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",IN_PROGRESS:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300",COMPLETED:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",CANCELLED:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300",OVERDUE:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"},x={LOW:"text-green-600 dark:text-green-400",MEDIUM:"text-yellow-600 dark:text-yellow-400",HIGH:"text-orange-600 dark:text-orange-400",CRITICAL:"text-red-600 dark:text-red-400"},g={INSPECTION:"\uD83D\uDD0D",PREVENTIVE:"\uD83D\uDEE0️",CORRECTIVE:"\uD83D\uDD27",CLEANING:"\uD83E\uDDFD",CALIBRATION:"⚙️"};function h(e){let{maintenance:t,onStatusUpdate:a,onPriorityUpdate:s}=e,n="OVERDUE"===t.status||t.scheduledDate&&new Date(t.scheduledDate)<new Date&&"SCHEDULED"===t.status,d=e=>{let t=new Date(e),a=new Date,r=new Date(a);return(r.setDate(r.getDate()-1),t.toDateString()===a.toDateString())?"Today ".concat(t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})):t.toDateString()===r.toDateString()?"Yesterday ".concat(t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})):t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},i=e=>null==e?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),l=e=>{a&&a(t.id,e)};return(0,r.jsxs)("div",{className:"bg-white dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg shadow-sm border ".concat(n?"border-red-300 dark:border-red-700":"border-gray-200 dark:border-gray-700"," p-4 space-y-3"),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("span",{className:"text-xs font-semibold text-brand-orange",children:[g[t.type]," ",t.type]})}),(0,r.jsx)(o(),{href:"/assets/".concat(t.asset.id),className:"text-sm font-semibold text-brand-primary-text hover:text-blue-600 dark:hover:text-blue-400 mt-1 block",children:t.asset.name}),t.asset.serialNumber&&(0,r.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["S/N: ",t.asset.serialNumber]})]}),(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(m[t.status]),children:t.status.replace("_"," ")})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Priority:"}),(0,r.jsx)("span",{className:"ml-1 font-semibold ".concat(x[t.priority]),children:t.priority})]}),t.scheduledDate&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Scheduled:"}),(0,r.jsx)("span",{className:"ml-1 ".concat(n&&"SCHEDULED"===t.status?"text-red-600 dark:text-red-400 font-semibold":"text-brand-primary-text"),children:d(t.scheduledDate)})]}),t.performedDate&&(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Performed:"}),(0,r.jsx)("span",{className:"ml-1 text-green-600 dark:text-green-400",children:d(t.performedDate)})]}),t.performedBy&&(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Performed by:"}),(0,r.jsx)("span",{className:"ml-1 text-brand-primary-text font-medium",children:t.performedBy.name||t.performedBy.email})]}),(t.estimatedCost||t.actualCost)&&(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Cost:"}),(0,r.jsx)("span",{className:"ml-1 text-brand-primary-text",children:t.actualCost?i(t.actualCost):"Est. ".concat(i(t.estimatedCost))})]})]}),t.description&&(0,r.jsx)("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:(0,r.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 italic",children:t.description})}),"COMPLETED"!==t.status&&"CANCELLED"!==t.status&&(0,r.jsx)("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:["SCHEDULED"===t.status&&(0,r.jsx)("button",{onClick:()=>l("IN_PROGRESS"),className:"px-3 py-2 text-xs font-medium bg-yellow-600 hover:bg-yellow-700 text-white rounded-md transition-colors",children:"Start Work"}),"IN_PROGRESS"===t.status&&(0,r.jsx)("button",{onClick:()=>l("COMPLETED"),className:"px-3 py-2 text-xs font-medium bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors",children:"Complete"}),(0,r.jsx)("button",{onClick:()=>l("CANCELLED"),className:"px-3 py-2 text-xs font-medium bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors",children:"Cancel"})]})})]})}function p(){let{data:e,status:t}=(0,s.useSession)(),a=(0,n.useRouter)(),[i,m]=(0,d.useState)([]),[x,g]=(0,d.useState)(!0),[p,u]=(0,d.useState)({status:"",type:"",search:""}),[b,y]=(0,d.useState)(!1),[j,k]=(0,d.useState)({page:1,limit:20,total:0,pages:0});(0,d.useEffect)(()=>{if("loading"!==t){if("unauthenticated"===t)return void a.push("/auth/signin");v()}},[t,a,p,j.page]);let v=async()=>{try{let e=new URLSearchParams({page:j.page.toString(),limit:j.limit.toString(),...p.status&&{status:p.status},...p.type&&{type:p.type},...p.search&&{search:p.search}}),t=await fetch("/api/maintenance?".concat(e));if(t.ok){let e=await t.json();m(e.maintenanceRecords),k(t=>({...t,...e.pagination}))}}catch(e){console.error("Failed to fetch maintenance records:",e)}finally{g(!1)}},N=async(e,t)=>{try{(await fetch("/api/maintenance/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok&&v()}catch(e){console.error("Failed to update maintenance status:",e)}},f=async(e,t)=>{try{(await fetch("/api/maintenance/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({priority:t})})).ok&&v()}catch(e){console.error("Failed to update maintenance priority:",e)}},w=async(e,t)=>{try{let a=await fetch("/api/maintenance/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok)v();else{let e=await a.json();throw Error(e.error||"Failed to update maintenance record")}}catch(e){throw console.error("Failed to update maintenance record:",e),e}},C=(e,t)=>{u(a=>({...a,[e]:t})),k(e=>({...e,page:1}))};return"loading"===t||x?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,r.jsx)(l.A,{}),(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-orange"})})]}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,r.jsx)(l.A,{}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto py-3 sm:py-4 md:py-6 px-3 sm:px-4 md:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"space-y-4 sm:space-y-6 md:space-y-8",children:[(0,r.jsx)("div",{className:"hidden md:block",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,r.jsx)("div",{className:"p-2 bg-white/5 dark:bg-white/5 hover:bg-white/10 dark:hover:bg-white/10 rounded-lg transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-brand-orange",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})})}),(0,r.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:"Maintenance"})]}),(0,r.jsx)("p",{className:"text-base text-gray-600 dark:text-brand-secondary-text",children:"Manage maintenance schedules and track repairs"})]}),(0,r.jsxs)(o(),{href:"/assets",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium inline-flex items-center justify-center transition-colors active:scale-95 touch-manipulation",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"View Assets"]})]})}),(0,r.jsxs)("div",{className:"md:hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-300 bg-clip-text text-transparent",children:"Maintenance"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-600 dark:text-brand-secondary-text",children:[(0,r.jsx)("svg",{className:"w-4 h-4 text-brand-orange",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})}),(0,r.jsx)("span",{children:j.total})]}),(0,r.jsx)(o(),{href:"/assets",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-md text-xs font-medium inline-flex items-center justify-center transition-colors active:scale-95 touch-manipulation",children:"Assets"})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-brand-secondary-text mb-4",children:"Manage maintenance schedules and track repairs"})]}),(0,r.jsx)("div",{className:"md:hidden mb-4",children:(0,r.jsxs)("button",{onClick:()=>y(!b),className:"w-full flex items-center justify-between px-4 py-3 bg-gray-900/5 dark:bg-white/5 rounded-lg border border-gray-300 dark:border-gray-700 text-left active:scale-95 touch-manipulation transition-all",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-brand-orange",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"})}),(0,r.jsx)("span",{className:"text-sm font-medium text-brand-primary-text",children:Object.values(p).some(e=>e&&""!==e)?"Filters Applied":"Show Filters"}),Object.values(p).some(e=>e&&""!==e)&&(0,r.jsx)("span",{className:"px-2 py-1 text-xs bg-brand-orange text-white rounded-full",children:Object.values(p).filter(e=>e&&""!==e).length})]}),(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-500 transition-transform duration-200 ".concat(b?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),(0,r.jsx)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-3 sm:p-4 md:p-6 ".concat(b?"":"hidden md:block"),children:(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[(0,r.jsxs)("div",{className:"sm:col-span-2 lg:col-span-1",children:[(0,r.jsx)("label",{htmlFor:"search",className:"block text-xs sm:text-sm font-medium text-gray-600 dark:text-brand-secondary-text mb-1",children:"Search"}),(0,r.jsx)("input",{type:"text",id:"search",value:p.search,onChange:e=>C("search",e.target.value),placeholder:"Search descriptions...",className:"w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-3 md:py-2 text-sm bg-white/80 dark:bg-white/5 text-gray-900 dark:text-brand-primary-text placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-manipulation"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"status",className:"block text-xs sm:text-sm font-medium text-gray-600 dark:text-brand-secondary-text mb-1",children:"Status"}),(0,r.jsxs)("select",{id:"status",value:p.status,onChange:e=>C("status",e.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-3 md:py-2 text-sm bg-white/80 dark:bg-white/5 text-gray-900 dark:text-brand-primary-text focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-manipulation",children:[(0,r.jsx)("option",{value:"",children:"All Status"}),(0,r.jsx)("option",{value:"SCHEDULED",children:"Scheduled"}),(0,r.jsx)("option",{value:"IN_PROGRESS",children:"In Progress"}),(0,r.jsx)("option",{value:"COMPLETED",children:"Completed"}),(0,r.jsx)("option",{value:"CANCELLED",children:"Cancelled"}),(0,r.jsx)("option",{value:"OVERDUE",children:"Overdue"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"type",className:"block text-xs sm:text-sm font-medium text-gray-600 dark:text-brand-secondary-text mb-1",children:"Type"}),(0,r.jsxs)("select",{id:"type",value:p.type,onChange:e=>C("type",e.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-3 md:py-2 text-sm bg-white/80 dark:bg-white/5 text-gray-900 dark:text-brand-primary-text focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-manipulation",children:[(0,r.jsx)("option",{value:"",children:"All Types"}),(0,r.jsx)("option",{value:"INSPECTION",children:"Inspection"}),(0,r.jsx)("option",{value:"PREVENTIVE",children:"Preventive"}),(0,r.jsx)("option",{value:"CORRECTIVE",children:"Corrective"}),(0,r.jsx)("option",{value:"CLEANING",children:"Cleaning"}),(0,r.jsx)("option",{value:"CALIBRATION",children:"Calibration"})]})]}),(0,r.jsx)("div",{className:"flex items-end sm:col-span-2 lg:col-span-1",children:Object.values(p).some(e=>""!==e)&&(0,r.jsx)("button",{onClick:()=>{u({status:"",type:"",search:""}),k(e=>({...e,page:1}))},className:"w-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 px-3 py-2 rounded-md text-xs sm:text-sm font-medium transition-colors active:scale-95 touch-manipulation",children:"Clear Filters"})})]})}),(0,r.jsx)("div",{className:"md:hidden space-y-3",children:i.map(e=>(0,r.jsx)(h,{maintenance:e,onStatusUpdate:N,onPriorityUpdate:f},e.id))}),(0,r.jsx)("div",{className:"hidden md:block",children:(0,r.jsx)(c.A,{maintenanceRecords:i,onStatusUpdate:N,onPriorityUpdate:f,onUpdate:w,showAssetColumn:!0})}),i.length>0&&j.pages>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"hidden md:flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600 dark:text-brand-secondary-text",children:["Showing ",(j.page-1)*j.limit+1," to"," ",Math.min(j.page*j.limit,j.total)," of"," ",j.total," results"]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>k(e=>({...e,page:e.page-1})),disabled:1===j.page,className:"px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 bg-white/80 dark:bg-white/5 text-brand-primary-text disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),(0,r.jsxs)("span",{className:"px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-blue-600 text-white",children:[j.page," of ",j.pages]}),(0,r.jsx)("button",{onClick:()=>k(e=>({...e,page:e.page+1})),disabled:j.page===j.pages,className:"px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 bg-white/80 dark:bg-white/5 text-brand-primary-text disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]}),(0,r.jsxs)("div",{className:"md:hidden space-y-3",children:[(0,r.jsxs)("div",{className:"text-center text-sm text-gray-600 dark:text-brand-secondary-text",children:["Page ",j.page," of ",j.pages," (",j.total," total)"]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>k(e=>({...e,page:e.page-1})),disabled:1===j.page,className:"flex-1 px-4 py-3 text-sm font-medium border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 bg-white/80 dark:bg-white/5 text-brand-primary-text disabled:opacity-50 disabled:cursor-not-allowed transition-colors active:scale-95 touch-manipulation",children:"← Previous"}),(0,r.jsx)("button",{onClick:()=>k(e=>({...e,page:e.page+1})),disabled:j.page===j.pages,className:"flex-1 px-4 py-3 text-sm font-medium border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 bg-white/80 dark:bg-white/5 text-brand-primary-text disabled:opacity-50 disabled:cursor-not-allowed transition-colors active:scale-95 touch-manipulation",children:"Next →"})]})]})]}),0===i.length&&!x&&(0,r.jsxs)("div",{className:"text-center py-8 sm:py-12",children:[(0,r.jsx)("svg",{className:"mx-auto h-10 w-10 sm:h-12 sm:w-12 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})}),(0,r.jsx)("h3",{className:"mt-2 text-sm sm:text-base font-medium text-brand-primary-text",children:"No maintenance records found"}),(0,r.jsx)("p",{className:"mt-1 text-xs sm:text-sm text-gray-600 dark:text-brand-secondary-text",children:Object.values(p).some(e=>""!==e)?"Try adjusting your filters":"No maintenance has been scheduled yet"})]})]})})]}):null}},43165:(e,t,a)=>{Promise.resolve().then(a.bind(a,15155))}},e=>{e.O(0,[2108,7244,280,8947,1287,8441,5964,7358],()=>e(e.s=43165)),_N_E=e.O()}]);