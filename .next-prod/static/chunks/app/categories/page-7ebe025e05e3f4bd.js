(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2379],{9137:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var s=t(95155),a=t(12108),i=t(35695),o=t(12115),n=t(48947);function d(){let{data:e,status:r}=(0,a.useSession)(),t=(0,i.useRouter)(),[d,l]=(0,o.useState)([]),[c,x]=(0,o.useState)(!0),[m,h]=(0,o.useState)(""),[u,g]=(0,o.useState)(!1),[p,b]=(0,o.useState)(null),[j,y]=(0,o.useState)({name:"",description:""}),[v,f]=(0,o.useState)(!1),[k,w]=(0,o.useState)("");(0,o.useEffect)(()=>{var s;if("loading"===r)return;if("unauthenticated"===r)return void t.push("/auth/signin");let a=null==e||null==(s=e.user)?void 0:s.role;if("ADMIN"!==a&&"MANAGER"!==a)return void t.push("/dashboard");N()},[r,t,e]);let N=async()=>{try{let e=await fetch("/api/categories");if(e.ok){let r=await e.json();l(r.categories.map(e=>({...e,isEditable:!["CAMERA","LENS","LIGHTING","AUDIO","COMPUTER","STORAGE","ACCESSORY","FURNITURE","SOFTWARE","OTHER"].includes(e.id)})))}}catch(e){console.error("Failed to fetch categories:",e)}finally{x(!1)}},C=()=>{y({name:"",description:""}),b(null),w(""),g(!0)},L=async()=>{if(!j.name.trim())return void w("Category name is required");f(!0),w("");try{let e=p?"/api/categories/".concat(p.id):"/api/categories",r=p?"PUT":"POST",t=await fetch(e,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}),s=await t.json();t.ok?(N(),g(!1),b(null),y({name:"",description:""}),w("")):w(s.error||"Failed to save category")}catch(e){console.error("Failed to save category:",e),w("Failed to save category. Please try again.")}finally{f(!1)}},E=async e=>{if(confirm('Delete category "'.concat(e.name,'"?\n\nThis action cannot be undone.')))try{let r=await fetch("/api/categories/".concat(e.id),{method:"DELETE"}),t=await r.json();r.ok?(N(),alert('Category "'.concat(e.name,'" deleted successfully.'))):alert("Error: ".concat(t.error||"Failed to delete category"))}catch(e){console.error("Failed to delete category:",e),alert("Failed to delete category. Please try again.")}},A=d.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.description.toLowerCase().includes(m.toLowerCase()));return"loading"===r||c?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,s.jsx)(n.A,{}),(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-orange"})})]}):e?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50/30 via-slate-50 to-indigo-50/20 dark:from-brand-dark-blue dark:via-gray-925 dark:to-brand-black",children:[(0,s.jsx)(n.A,{}),(0,s.jsx)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm shadow-sm border-b border-gray-700",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"p-1.5 bg-white/5 dark:bg-white/5 hover:bg-white/10 dark:hover:bg-white/10 rounded-lg transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-brand-primary-text",children:"Categories"}),(0,s.jsxs)("p",{className:"text-sm text-brand-primary-text",children:[d.length," total"]})]})]}),(0,s.jsxs)("button",{onClick:C,className:"bg-indigo-600 hover text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center space-x-2 shadow-sm hover:shadow-md transform hover:scale-[1.02]",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,s.jsx)("span",{children:"Add Category"})]})]})})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,s.jsx)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg border border-gray-700 p-4 mb-4",children:(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("input",{type:"text",placeholder:"Search categories...",value:m,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm"})}),(0,s.jsx)("button",{onClick:()=>h(""),className:"px-4 py-2 text-brand-primary-text hover border border-gray-600 rounded-lg hover transition-colors text-sm",children:"Clear"})]})}),(0,s.jsxs)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg border border-gray-700 overflow-hidden",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,s.jsx)("thead",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/60 dark:text-white/60 uppercase tracking-wider",children:"Category"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/60 dark:text-white/60 uppercase tracking-wider",children:"Code"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/60 dark:text-white/60 uppercase tracking-wider",children:"Description"}),(0,s.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-white/60 dark:text-white/60 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm divide-y divide-gray-300",children:A.map(e=>(0,s.jsxs)("tr",{className:"hover transition-colors",children:[(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center mr-3",children:(0,s.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),(0,s.jsx)("div",{className:"text-sm font-medium text-brand-primary-text",children:e.name})]})}),(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 dark:bg-gray-800 text-brand-primary-text",children:e.id})}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600 dark:text-brand-secondary-text",children:e.description}),(0,s.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm",children:(0,s.jsx)("div",{className:"flex items-center justify-end space-x-2",children:e.isEditable?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:()=>{y({name:e.name,description:e.description}),b(e),w(""),g(!0)},className:"text-indigo-600 hover transition-colors font-medium",children:[(0,s.jsx)("svg",{className:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),(0,s.jsxs)("button",{onClick:()=>E(e),className:"text-red-600 hover transition-colors font-medium",children:[(0,s.jsx)("svg",{className:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]}):(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1 text-white/50 hover:text-white/80 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),(0,s.jsx)("span",{className:"text-xs text-white/50 hover:text-white/80 transition-colors",children:"System"})]})})})]},e.id))})]})}),0===A.length&&!c&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("svg",{className:"mx-auto h-12 w-12 text-white/50 hover:text-white/80 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-medium text-brand-primary-text",children:m?"No categories found":"Ready to organize your assets?"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-brand-secondary-text",children:m?"Try adjusting your search terms or clear the search to see all categories.":"Create custom categories to better organize your inventory beyond the system defaults."}),!m&&(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsxs)("button",{onClick:C,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Your First Custom Category"]})})]})]})]}),u&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white/90 dark:bg-brand-dark-blue/90 backdrop-blur-sm rounded-lg p-6 w-full max-w-md mx-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-brand-primary-text",children:p?"Edit Category":"Add Category"}),(0,s.jsx)("button",{onClick:()=>g(!1),className:"text-white/50 hover:text-white/80 transition-colors hover",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[k&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{className:"text-sm text-red-700",children:k})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),(0,s.jsx)("input",{type:"text",value:j.name,onChange:e=>y({...j,name:e.target.value}),disabled:v,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text focus:ring-2 focus:ring-indigo-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"e.g., Drones, Cables, Stands"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),(0,s.jsx)("textarea",{value:j.description,onChange:e=>y({...j,description:e.target.value}),disabled:v,rows:3,className:"w-full px-3 py-2 border border-gray-600 rounded-lg bg-gray-900 text-brand-primary-text placeholder-gray-600 focus:ring-2 focus:ring-indigo-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Brief description of what assets belong in this category..."})]}),(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-blue-400 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,s.jsx)("p",{className:"font-medium mb-1",children:"About Category Codes"}),(0,s.jsx)("p",{children:'A unique code will be automatically generated from your category name (e.g., "Drone Equipment" â†’ "DROEQU"). This code is used in asset numbering like LSVR-DROEQU-0001.'})]})]})})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,s.jsx)("button",{onClick:()=>g(!1),disabled:v,className:"px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,s.jsxs)("button",{onClick:L,disabled:v||!j.name.trim(),className:"px-4 py-2 bg-indigo-600 hover text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[v&&(0,s.jsxs)("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l-3-2.647z"})]}),v?"Saving...":p?"Update Category":"Add Category"]})]})]})})]}):null}},20936:(e,r,t)=>{Promise.resolve().then(t.bind(t,9137))}},e=>{e.O(0,[2108,7244,8947,8441,5964,7358],()=>e(e.s=20936)),_N_E=e.O()}]);